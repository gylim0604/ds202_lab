---
title: "Lab 2"
author: "Blake Inderski"
date: "2/5/2019"
output:
  html_document: default
  pdf_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
choco <- read.csv("https://xdaiisu.github.io/ds202materials/hwlabs/choco.csv")
#head(choco)
library(ggplot2)
```
**Individual question set**

Individual 1 - How are ratings distributed? Draw a histogram of ratings and describe it. Donâ€™t forget to mention outliers, if there are any.
```{r}
hist(choco$Rating)
summary(choco$Rating)
iqr <- IQR(choco$Rating)
length(which(choco$Rating < summary(choco$Rating)[["1st Qu."]]-1.5*iqr)) #count of lower outliers
length(which(choco$Rating > summary(choco$Rating)[["3rd Qu."]]+1.5*iqr)) #count of upper outliers
```
Ratings are skewed left. Mean rating is 3.191, median rating is 3.25. There are 49 lower outliers and 2 upper outliers for a total of 51 outliers.
<br /><br />

Individual 2 - Do ratings depend on the cacao percentage of a chocolate bar?
```{r}
#ggplot(choco, aes(x=Rating, y=Cocoa.Pct)) + geom_point()
pct_v_rating <- boxplot(Cocoa.Pct ~ Rating, data = choco) #ratings are descrete
#pct_v_rating$stats
```
While most chocolates rated have approximately 70% cacao percentage, the candies that had greater cacao amounts corresponded to lower rating.
<br /><br />

**Team question set**

Q1 - What is the overall number of chocolate bars rated?
```{r}
ratingCount <- length(choco$Rating)
print(ratingCount)
```
1852 chocolate bars were rated.
<br /><br />

Q2 - How does the number of ratings depend on the year? Draw a bar chart of the number of reports.
```{r}
dateTable <- table(choco$Review.Date)
barplot(dateTable)
```
<br />Number of ratings is skewed left.
<br /><br />

Q3 - How do ratings compare across different company locations? Focus on the three locations with the most ratings. (Hint: They are U.S.A., France, and Canada, but find them out using codes.)
```{r}
location_df <- data.frame(table(choco$Company.Location))
sortRating <- location_df[order(-location_df$Freq), ][1:3, ] #three countries with most ratings
top3 <- as.matrix(sortRating$Var1)
extract3 <- choco[choco$Company.Location %in% top3, ]
extract3 <- droplevels(extract3)
rating_v_location <- boxplot(Rating ~ Company.Location, data = extract3)
rating_v_location$stats
#ggplot(extract3, aes(x=Company.Location, y=Rating)) + geom_boxplot()
aggregate(Rating ~ Company.Location, data = extract3, mean)
```
Median ratings for the top 3 (Canada, France, USA) is equal at 3.25. Canada has the highest mean rating (3.31), followed by France (3.25), and then U.S.A. (3.16).
<br /><br />

Q4 - Brainstorm and write down an interesting question that can be answer from the dataset. The question should not duplicate the questions above.

What is the most prevalent bean type?
<br /><br />

Q5 - Answer the question from the dataset.
```{r}
bean_type <- as.matrix(choco$Bean.Type)
labeled_bean <- bean_type[bean_type != ""]
total_labeled_bean <- c()
for (str in labeled_bean) {
  split_values <- strsplit(str, '\\s+')[[1]]
  for (value in split_values) {
    if (grepl("\\(|\\)", value) == FALSE) {
      value_sub <- gsub("\\,", "", value)
      total_labeled_bean <- c(total_labeled_bean, c(value_sub))
    }
  }
}
#print(length(labeled_bean))
#print(length(total_labeled_bean))
bean_df <- data.frame(table(total_labeled_bean))
sort_bean <- droplevels(bean_df[order(-bean_df$Freq), ][1:4, ])
ggplot(sort_bean, aes(x=total_labeled_bean, y=Freq)) + geom_bar(stat="identity") + 
  xlab("Bean.Type") + 
  ylab("Count") + 
  ggtitle("Count of four most common bean types")
```
<br />Trinitario was the most common bean type, comprising nearly half of all recorded beans used for chocolate bars. The other two most common bean types were Forastero and Criollo. Other bean types seemed to be given vauge labels and often had low counts. An example of a vauge label was the fourth most common bean type label, Blend.
